<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>



<style>
.mr10 {margin-right: 10px;}

#toolbar {
  margin: 0;
}

body {
    padding: 15px;
}

table {
    border-collapse: separate;
    border-spacing: 0 5px;
}

thead th {
    background-color: #006DCC;
    color: white;
}

tbody td {
    background-color: #EEEEEE;
}

tr td:first-child,
tr th:first-child {
    border-top-left-radius: 6px;
    border-bottom-left-radius: 6px;
}

tr td:last-child,
tr th:last-child {
    border-top-right-radius: 6px;
    border-bottom-right-radius: 6px;
}

tbody>tr:nth-child(odd)>td,
    tbody>tr:nth-child(odd)>th {
        background-color: AliceBlue;
    }
tbody>tr:nth-child(even)>td,
    tbody>tr:nth-child(even)>th {
        background-color: LemonChiffon;
    }



</style>
</head>
<body>
<button onclick="myFunction()">Click me</button>
<button onclick="myFunction1()">test getData</button>

<div class="toolbar">
  <div>
    <label class="checkbox">
      <input id="height" type="checkbox" checked> Enable Height
    </label>
  </div>
  <div class="form-inline">
    <span class="mr10">Fixed Number: </span>
    <input class="form-control mr10" id="fixedNumber" type="number" value="2" min="1" max="5">
    <span class="mr10">Fixed Right Number: </span class="mr10">
    <input class="form-control" id="fixedRightNumber" type="number" value="1" min="0" max="5">
  </div>
  <div class="form-inline">
    <span class="mr10">Cells: </span>
    <input class="form-control mr10" id="cells" type="number" value="3" min="1" max="30">
    <span class="mr10">Rows: </span class="mr10">
    <input class="form-control mr10" id="rows" type="number" value="3" min="1" max="50">
    <button id="build" class="btn btn-secondary">Rebuild Table</button>
  </div>
</div>

<div id="toolbar" class="select">
  <select class="form-control">
    <option value="">Export Basic</option>
    <option value="all">Export All</option>
    <option value="selected">Export Selected</option>
  </select>
</div>
<table id="table"></table>

<script>

function myFunction1() {
	var arr_link = [
			['AKfycbzQ', '2ubS-F', '6crdo', '2fewL', 'W-650mMz', '-UW0CJy', '_uZeoI', 'T2XnjZ7zYc', 'EHyVy3', 'To37M2', 'w5_8'],
      ['AKfycbz7', 'VmOveh', 'GdyoL', 'TQ76o', 'ku3rn-Z1', 'RgMmzyu', 'QNUaw_', '-8V-MdHGqa', '2tyggO', 'r-_YnW', 'MCl_f'],
      ['AKfycbyd', 'nw73Bg', 'AkjsB', 'FjDoA', 'Rw5lorU-', '78hV11N', 'Yn-Gob', 'hUirSpybgc', 'bv-JSs', '88tB9b', 'UdAEl'],
      ['AKfycbzk', '1oT1-I', 'Ft1If', 'MHSjy', 'LKK78bsv', 'AUD-PLn', 'oxMnMj', 'KdmV9c042x', 'TenuJq', 'QINjau', '1cZk'],
      ['AKfycbzp', '-J_L0W', 'GTdJL', 'fzSwP', 'b022iLOa', '8gBq8V0', '0TGV1-', 'H-O11H9BfN', 'wpSWzA', 'EGXol_', 'zIBA'],
      ['AKfycbwa', '3a2dZO', 'HzCOd', 'hysiW', 'WC3PXPu5', 'N4q2Ujz', 'YBeo6t', 'RqDkS7Dlya', 'af3ViT', '28mF8O', 'ymra1'],
      ['AKfycbyV', 'd9gND4', 'E672F', 'jknHC', 'SJTbmyCH', 'hotkoTp', 't6sA-7', 'G7s0iC9xz2', 'KqK_DR', 'ZlWXNB', 'MU00'],
      ['AKfycbwF', 'w1Zhjk', 'HQREI', 'JxQih', 'nrviDElD', 'YHoZKai', 'm9b2Au', '8tWGH4WNFH', 'TX36VK', 'ju0LgF', '7vp0'],
      ['AKfycbwj', '5F11l8', '2YkTr', 'DlZr2', '-KYKNbFb', 'IImEerf', 'NOhLNW', 'dL2MSWMUTJ', 'TeZ34W', 'pb5acY', 'y4M0w'],
      ['AKfycbyN', 'vt4TPH', 'q0Leh', 'pi9oV', 'kfU6nIGm', 'Ok2KBmr', 'HMCnzF', 'wWpcUErwI4', 'vpv7X5', 'Bq3Npf', 'EIZQ'],
      ['AKfycbw2', 'xxelbl', '523Pi', 'ZRBgw', 'LOSkfsve', 'xa98Zsh', 'pkg2B7', 'DaZdHxzjEq', 'v8dyT5', 'JfBtP-', 'JiY8'],
      ['AKfycbyB', 'wylMYJ', 'ISXM3', '0gNhf', '--HL5klr', 'TEIAMaU', 'qrs80z', 'g_yrO7VYjC', 'BY_baA', 'pWJC1E', 'XJts'],
      ['AKfycbxS', 'Tmv5eX', 'SJ5em', 'umgy3', 'qfHh1u05', 'uC46We9', 'A0cNsh', 'EQW0Fzlpr2', 'pC_0_i', 'vwmFMw', 'lnpxv'],
      ['AKfycbw_', '_6y0A5', 'Wws9A', 'FTk2T', 'xmWE5ET_', 'E8d8t4G', 'dklFJY', 'JoZcYOFdYs', 'bE6zpg', 'etePfb', 'aE5g_'],
      ['AKfycbyQ', 'jXyaPD', 'RbtYA', 'WzAy7', 'wjUQ5EmM', '4cKXtY8', '1hdgtd', 'AvatIaXiAm', '-O6ljE', 'gXiXqY', 'hhxu6'],
      ['AKfycbxJ', 'Ke1WoT', 'LiarG', '4DPsH', 'rw2l8a6Q', 'RrCQlhw', 'SP4TA6', 'T4ayCe_ycM', 'wUMpRO', 'jjlma_', 'sCR8'],
      ['AKfycbyZ', 'oVQ7kV', 'eEyLs', '2HWMe', 'YKlnvc1F', 'ZNiMGfV', 'WZbxGU', 'EABfi2ybAu', 'e3q8TP', 'ThDem_', 'xL8Cj'],
      ['AKfycbw6', 'L2YqbU', 'VWTvz', 'dRcoS', 'D0ish7Ff', 'WC-Ily6', 'wOjm26', 'MmcJ7gh_I8', '7DM5mG', 'Sl7yto', 'OQns'],
      ['AKfycbyW', 'h-DrKA', 'KTtBH', 'KXgWk', 'Q2bbD8IQ', 'nQjpRMG', 'rVr1HH', 'E-zpWeMhGs', 'wsM_in', '4nEYl-', 'fgjsH'],
      ['AKfycbw6', 'ZDNv0x', 'GrKT-', 'llYOH', 'XcFWE8WM', 'qiWCga2', 'DBoO00', 'wVhtzh45w8', 'JjZU9Y', 'ihb6y-', 'tEfI'],
      ['AKfycbxH', 'Na5mLr', 'lsxMP', 'bk0c3', 'BVdr6GSq', 'aTOjd7s', 'b-p3E-', 'cbmk-OOdBj', 'plqNhe', 'lnEZcv', '4AGKV'],
      ['AKfycbxn', 'ZkprAl', 'vAvlU', 'tRtlO', 'zX2eG-uA', '029sH0y', '76wiff', 'VbD0UzBeCs', 'WCpPNG', 'K-YBZT', 'OoIr6'],
      ['AKfycbyr', 'awu4EK', '1M369', 'LD7FZ', 'eSy2dTna', 'Z-rexpR', 'xy3p4d', 'aYvTseJde4', 'AUGAaI', 'ramvq0', '5hYU'],
      ['AKfycbyY', '_mOBDU', 'qLoMg', 'Hqysh', 'zSS2Kehi', 'M3AeBoX', 'rgoNCF', 'zPkmEDoxSN', 'khARc2', 'x4Nqqa', 'qkzR9'],
      ['AKfycbwa', 'Zb0ho6', 'vwTf_', 'Kt4eM', '3verqP72', 'xhJzx8P', 'uywnVh', 'IH_NEs0gpI', 'VWyq0g', 'jlA1My', 'Kwlh2'],
      ['AKfycbwk', 'mPoHCG', 'Pb7wy', 'kIBLV', 'XBz6UsTM', 'RhvzS6o', '6esrGv', 'vAKUe4-i0J', 'JSef7O', 'ctojxc', 'nx3s'],
      ['AKfycbyz', 'FPheos', '2pm7G', 'f6bl5', '3nbONZlY', '5NoqL3N', 'Zv1Gbe', 'rLCQdvsDC1', '4CQjFR', 'T3Hm8-', '5Mrc'],
      ['AKfycbxr', 'w_6ce8', 'SfJGd', 'wc4UB', 'PsKA8IHo', 'VBFJg1K', 'a2tmMr', '4AoA4Q53ep', '_tZOVk', 'j7ZW7x', '6glLm'],
      ['AKfycbzj', 'HHhe43', 'j-PqV', 'sEnww', 'fg9jCeid', 'Hwhhh5Y', 'qSXit-', 'DYhHvbowGa', 'LA7PuW', 'xVcFco', 'WtLHT'],
      ['AKfycbzk', 'DKjBCQ', 'mf-5B', 'mdy9-', 'xHwPaRMk', 'zy5DiEl', 'xXCHtY', 'UVPNF4p4xo', 'LfJsxF', 'MBv-Ln', 'cbBg8'],
      ['AKfycbyU', 'fB9LeY', 'hLd99', 'Sp8X8', 'mlZ0-kDH', '4E2Zaou', 'LSV3H-', 'BurhRpod8Q', '27xc3l', '2ZC-4Q', 'azXcD'],
      ['AKfycbxc', 'y2-7Fp', '7g77h', 'LHTV1', 'lOk__RvS', 'sqBxdiC', 'ijJ2Gz', 'SvaeYUwoae', 'n6kwKH', 'kmSle_', 'XMwY'],
      ['AKfycbzl', '2-lxwF', 'vl_jS', 'eu19K', '_OzJi6UN', 'wnz2OKf', 'f352ZP', 'hmQvFc8TCl', 'uYzAZd', '-m3p98', '1y4Cw'],
      ['AKfycbzh', 'zM6EWh', 'QB8WL', 'VaREm', 'h0msil_3', 'wH8aG23', '5noJke', 'I9phGqBQd6', '0tbvWM', 'bR4KPI', 'Ettc5'],
      ['AKfycbzO', 'kWuRmv', 'kKQlY', '5xnFO', 'yld3dAV9', 'HLc3aNG', 'ZIYoKy', 'H7qUXul-Eb', 'lkcLHN', 'YI0Vy6', 'BmZ3G'],
      ['AKfycbwL', 'z99ysG', 'SBBVs', 'op4TC', '4RrgqubO', 'erqrc_b', 'QrIll2', 'KeyfsRsfsr', 'AjpNPQ', 'wZSz0Z', 'FCtA'],
      ['AKfycbxF', '5eXhfN', 'TDUCb', 'HFzD9', '4nE1V867', 'XBl_LJ1', 'YjNLc8', 'z5JBqZBuAG', '0NkFof', 'OMbThi', 'nYjjw'],
      ['AKfycbwh', 'wMAGNf', '-Cofb', 'kYYW_', 'KcmEdfvz', '1W68oYD', 'lWzhRt', 'vC2Zj-adsE', 'Q4t3fj', 'qU0Pmw', '2pOM'],
      ['AKfycbxE', 'kSB1kk', '1W67r', 'tqWis', 'OvGd2haF', 'p44a6eS', '2_g9us', '4XExULQfUe', 'h2fAy6', 'j6qpRj', 'MMy4'],
      ['AKfycbxB', 'NYHHxc', '0jjem', 'WzjC7', 'uf0URSVh', 'DDixzI8', 'l83h0K', 'KXwDGlrrxP', 'hp1-vz', 'FrURCa', '2RC4'],
      ['AKfycbwD', 'INS-k5', '0rjMa', 'g__cn', 'ipou1fxR', 'bCsWScQ', 'Z7F7Be', '4SnM_Po5vh', 'Zyem-t', 'z4L2HC', '73bPA'],
      ['AKfycby0', 'Evn3Nj', 'M8sb7', 'WGRCp', '4PWrLLgG', '1RxyxIc', 'Mo5giI', 'FlXTJ1sH_y', 'GYBox_', '7NSau-', 'M4SO1'],
      ['AKfycbx-', 'Y8SApW', 'l3dq3', 'kX25F', 'mDxAl9TD', 'IAAOuK2', 'JRD7qA', 'm8F9I90obG', 'JNJxg_', '5WOScz', 'UlOsC'],
      ['AKfycbxc', 'da2kRS', 'Q_Hj5', 'ECbrh', 'Cu2yF2wx', 'AZuHKSF', 'KKpJnb', 'CtXaSc957h', 'A4RS8G', 'XnkYGt', 'fp7Y'],
      ['AKfycbye', 'j-EuFP', 'alJuw', 'cOcMo', 'jMbKOV-t', '2W9LzsK', 'j6FoDm', 'UTAURgp2HJ', 'S76SoL', 'PQaGef', 'JaHdE'],
      ['AKfycbzV', 'm7NOvf', 'oQ2DV', 'PpHBu', 'limD-Qba', 'd-mh5fu', 'HIpyoD', 'jXA_Sq6IyE', 'YffV3q', 'dKeZqI', 'EgRuu'],
      ['AKfycbzs', '6J4_eY', 'Hlwzw', 'Bc5Av', 'K-8ST85n', 'h8huIQ2', 'vMH0rz', 'qwZY0tFAFm', 'tYcg6j', 'xikLFl', 'z_EI'],
      ['AKfycbzp', 'af5JCh', 'AIrOo', '_Bm3e', 'fzjOwfZ1', 'Eui0Ky0', 'RZq3vE', 'i1LFUklv6t', 'llZStX', 'ucCB23', 'wAmk'],
      ['AKfycbwK', 'ZZpzLq', 'QzYxv', 'pk6GG', 'C__F4-K3', 'GEOWvMy', 'hIThsX', '4UnwDXJ4va', 'qpBJd8', 'voXu38', 'yiqM'],
      ['AKfycbwC', 'xpC-ki', 'pDfwB', 'KfhVk', 'bkYdO-il', 'd7dG6v5', 'm1u5HK', 'A-NT4PXbVN', '7FuAZ8', 'R6EEm5', 'CV-c'],
      ['AKfycbyh', 'xxJGSs', 'QVT5b', 'ix0vl', 'gyuXUVnR', '8Pw2Jaj', 'CmlxPt', '_PSW4KIrG0', 'vCg80u', 'LD_GxQ', 'qCTfG'],
      ['AKfycbyS', 'TuTHZe', 'xdVx5', 'GHk0U', 'vowWL8zS', 'ndUeF27', 'f5Lz8B', 'czxE0qfQdB', 'NlJ5PY', 'M6HouB', 'ePsdE'],
      ['AKfycbwW', 'aTb81-', 'TAP-I', 'rtNWf', 'A0qoBlYl', 'nb6zgOg', 'FM10Q6', 'R9EwRI1Gyc', '6IDG9t', 'eJ82uK', '6MHA'],
      ['AKfycbyZ', 'qg8vkY', 'kGUfb', '8fHk8', 'oJQ2Di9o', 'TAp7snp', 'U1I_-P', 'XJrCTMNtzp', '8gkO3O', 'a8uMpj', 'Jbms'],
      ['AKfycbza', 'GF5O8a', 'XaI6q', 'aEgr4', 'Gi2uRioJ', 'nLGNTXn', 'THpk4-', 'aE-Fg_5Rgy', 'gCSzsB', 's-xWPx', 'kFeh0'],
      ['AKfycbxW', '9SXHTe', 'P-0Y_', 'NlovO', '3t9Dj1u_', '2Bi-INr', 'mVLhSO', '7bZWwSpfpG', 'iMoPvY', '1Gabpn', '4UXdL'],
      ['AKfycbzO', 't4fqyX', 'RDjPY', 'LWEA1', 'dSUD6rlJ', 'YaXrMz2', 'H9aR6B', '1MWttmgmJC', 'fp7TW9', '_b_zds', 'zO9A'],
      ['AKfycbw9', '_zVQfD', 'xYXuV', '8yAPj', 'lvrv2wLj', 'z0qanNA', 'orG0yj', 'fdbwyhVZrZ', 'ixTi-s', 'gJMkFG', 'mb39n'],
      ['AKfycbzw', 'dy-94W', 'VDp1P', 'uAWRe', '3G7akUlV', 'ZLS8-3L', 'Anj6Vr', 'JMQnQnZCSr', 'v0-p4r', 'cdgb8U', '-K8o'],
      ['AKfycbzz', '5j4f07', 'BQfbG', 'q8edX', 'c6K1wvQW', 'UCNxbnx', 'zpVX0p', '20s-1RM79r', 'tkizmR', 'mc0uFZ', '4oaTG'],
      ['AKfycbye', '1sVVrw', 'ubE4-', 'SJ_d_', 'AJ-ED3cV', 'GWkpw4a', 'iU1EVE', 'Bj9mu5zG1i', 'GSTL-7', 'TjKWCx', '6LGEX'],
      ['AKfycbxm', 'D_FzVR', 'tFQLz', 'TGFGj', 'vvGHtoin', 'E07LECS', 'Y8MIBm', '8mrJEhyO1s', 'iZGOK2', 'Dzeat9', 'NFgH5'],
      ['AKfycbxL', 'Ng8VH9', 'xKaE9', '3eilZ', 'NP5NtQ70', '5t96yzw', 'IEpI0i', 'jGrWB93tEY', 'T7lEz3', '2ybxG1', 'tJMGd'],
      ['AKfycbwP', 'FpJt53', 'Y7y4v', 'RzwZl', '8b5oe5Oh', 'zuKC8Om', 'Y6_Kfq', '28utqUlHM7', 'sThINy', '0nCGVL', 'Kzwo'],
      ['AKfycbxs', 'm62fon', 'w4nRY', 'VziVK', 'odviPsrH', '2t1iQ5m', '4HuhoP', 'Ue-Oh89a8b', 'GF1wGh', 'rOljaO', 'Zoio'],
      ['AKfycbwR', 'nnSEJn', '-3utW', 'sWeti', 'AodOls1O', '1HwUvx_', 'kyPX-h', '7Bb5bo7vMo', 'Qt-vWB', '64HG-Y', 'qaEk'],
      ['AKfycbzW', 'WjQXMr', 'Z5bcw', 'Or2U9', '8NbiBRpg', 'YEyTVY7', 'dk8Cqh', 'EE6sHvxf6m', 'XzrmAc', 'yhNwej', 'kUCOd'],
      ['AKfycbxz', 'ur4_Mp', 'ByrHh', 'Ltbkb', 'V3-qdyGJ', 'oEfbLjm', 'Aye3Sh', 'PViC7f_85l', 'xzFvwi', 'eZ6Vvi', 'SNto'],
      ['AKfycbxv', 'fb2wGT', 'OtPl6', 'UACV9', 'AmqW7Ptm', 'Bda4ln4', '84yOYQ', 'Vd29Cas_qh', 'iZVx7u', 'X5QE5R', 'rb-KU'],
      ['AKfycbwz', '5pKk0D', 'SekpE', 'QiWwz', 'fgIKqiWi', 'msZpls2', 'q4zqv6', 'QtKeIowTWT', 'u6Azmb', 'uF4UwC', 'RA7KF'],
      ['AKfycby2', '8BT5Iv', 'peIKr', 'D88Eo', 'cN8nN0hu', 'kqdJXv_', 'BmTPOo', 'u2f7Cq-7mz', 'K0kWoH', 'Kfs4ea', 'PkWg'],
      ['AKfycbx7', 'dIK9Lz', 'Knv9V', 'jBbJD', '0tcsRD7e', 'UVo5KaY', 'hWx1A3', 'zmMmn6mZkG', '_4sHzh', 'f-jrtV', 'cTQ'],
      ['AKfycbym', 'Pvg_BJ', '921bV', 'a_Rfw', 'C9qNOjfy', 'PIATeqb', 'i3WZbp', '2Bp6LHOhwr', 'dggVXb', 'AGa4C4', 'fAwZv'],
      ['AKfycbzY', '36B7ou', 'iqTph', '77CwQ', '9vj4CxP2', 'qX_iuu5', 'tfRYjU', 'IzKQYMvHop', 'AC1bxo', 'vqFYLg', '3kaI'],
      ['AKfycbxN', 'BWwKNf', 'QP-5R', 'f9e3T', 'JS3FfL9L', 'i70K6J7', 'vQ6ccg', 'MxxobXdhJm', 'kcOL8X', '9dL-Et', 'n3QJJ'],
      ['AKfycbx3', 'w1fcKF', '1tFwL', 'gtfPb', 'NRuk4o4I', '39cSm0W', 'rJp2Nj', 'x4JnOIuiWF', '1-LTpo', 'YvHgzT', 'DfCrE'],
      ['AKfycbya', 'IV0XgE', 'IfU8X', '17FZF', 'BN-pA1VV', '6azoD2I', 'Nn9Xkd', 'fUKHRikR4q', 'rHi-h9', 'NADpsr', 'Zw5A'],
      ['AKfycbxM', 't9lRAt', 'sNDEe', 'NOSgn', 'WLispQJ0', 'wZLqDMc', 'LGtylu', 'KDn12f-t1k', 'GboK0M', 'yNiZcy', 'sjA'],
      ['AKfycbyJ', 'ImLVyJ', 'lLLdr', 'QdgIK', 'MxRKgM7Q', 'MD9i_Wb', 'SiBTUZ', 'fxRCZjcAI0', 'w0Hutp', 'QY5bTX', 'Vo8s'],
      ['AKfycbzp', 'X6pceE', 'MQw-4', 'JLa_S', 'aRsXGESu', 'wgHtXX7', 'fil3zC', 'SbyFD-FL7M', 'j-xIn5', '5ufsiO', 'rAY0'],
      ['AKfycbz5', 'vUD1uW', 'G9mrs', 'r-egU', 'vD1mBYd1', '9tYA_K4', '0mMpzd', 'ZewphNTp2z', 'Rheq95', 'VwtN_F', 'A8-I'],
      ['AKfycbwI', 'Uq2sER', 'KyisU', 'I0hVN', '316ZoNXe', 'riXHRaf', 'JSsJxt', 'tt8eDlTLij', 'w0MgX7', 'KixwmL', 'nO40'],
      ['AKfycbxb', 'wwZKsE', 'Ydm4b', 'yEf6V', 'XrAe1mvG', 'Mk6SC17', 'lAdXu0', 'LHa82LNsEt', 'YkpjDb', 'GfrP2v', 'akNGm'],
      ['AKfycbzJ', '7sKEDb', 'iqTNP', 'PZN7I', 'xBIMoKi8', 'h00vQeT', '9VAAu1', 'bPTHz_gusf', '1KVpT4', 'bu9FQu', 's7IU'],
      ['AKfycbzp', 'eAbJ4w', 'gqDbJ', 'IiHTL', '-Yw28wDX', 'TbuIQiP', 'Pq1bXY', 'l9XzrI3d9X', 'rNreNL', 'cPQVF5', 'bEFhf'],
      ['AKfycbwK', 'XBKBAB', 'Son5-', 'QD0rp', '6Xg7Rsnr', 'D5g-FIK', 'N6NITQ', 'VZb_1iir0g', 'LqEKa5', '3oC_DL', 'Jlf36'],
      ['AKfycbwr', 'S8gzrW', 'HUdDX', '-8aEu', 'fR8TrniL', 'Y54JX2n', 'RlQQ4u', 'iCBhXLJ9XE', 'vCn6ao', 'vhrPrl', 'lWT4'],
      ['AKfycbyw', 'QwxJeJ', 'j8p1A', 'naovF', 'eH45fspV', 'FU7X-24', 'fcWvZ7', 'lhqjLfwA2e', 'Hpew4g', '1QCWDm', 'sQGCd'],
      ['AKfycbzp', 'huxEtx', 'nttCS', 'TEoAr', 'eHANA-S9', 'xLCr8d-', 'CFvCo2', 'J7liULKufW', 'Hu4lOa', '0DEhMp', 'ORHQ7'],
      ['AKfycbws', 'vqePtE', 'XzAKV', 'cRN-q', 'TeD5VLXi', 'PiM0X7A', 'hCXF6c', '5lpnyT9RFD', '1kWyVo', 'wGbgKF', 'KdA'],
      ['AKfycbwP', 's1rdpT', 'xGVaB', 'CIQmn', 'YxHKZcJK', 'Ea1Xd1E', 'Ku5tJU', '0LQCME9w4v', 'P6VDWJ', 'xn-pJv', 'BySp5'],
      ['AKfycbzo', 'iN4VnP', 'NBQ6o', 'C-rqY', 'dBrs-YO6', 'iY7XHhF', 'mt4t8f', 'AmDIrnKkAW', 'egPzkN', 'srwzcO', 'QV2e4'],
      ['AKfycbxV', 'lRPwT4', '5rUs-', 'g0cJz', '61aDL5xL', '3TncUKl', 'FczcDg', 'f8CHkwjQ1v', 'p6h6Ac', '6gLs4A', 'WRxgC'],
      ['AKfycbx9', 'IcVqj1', '3BgSZ', '82_1B', 'nmrmxEpO', 'gUXH6hE', 'LlN9pa', '1Q3oXDoGCM', 'o0VBU1', 'Cy9WXe', 'XxHES'],
      ['AKfycbzh', 'IjO-c3', '1IQLB', 'NQy32', 'dmiOHfmx', 'M5_xzbQ', 'G8gd7C', 'bg03ECUpZi', '_jJnQ_', 'S4hMaq', '9OV8'],
      ['AKfycbxh', 'b2DIX6', 'J1Nwv', 'Vgen9', '16i826Aw', 'WXn6Wcs', 'Hqkbj_', 'iIBHqo1Nfv', 'rZt-b9', 'ewYAzp', 'cCco'],
      ['AKfycbwL', 'PJKf6B', 'o20aZ', 'mGjd4', 'br70_4NA', 'DRLLB01', 'goQpsp', 'bty-yjPGVQ', 'P4_f0p', 'eYJeYf', 'MBg'],
      ['AKfycbya', 'uakpIl', 'osXAx', 'ULm_O', 'PoBQyVlz', 'eaja3PX', 'xzbLY-', '81S4r8GSo3', 'puL_Au', '5F3TRA', '7ozw'],
      ['AKfycbx9', 'pUqq_-', 'nVFd8', 'gjlpv', 'MvrHCgEV', 'JcwvfMo', '6b7foW', 'LdjwwHU6bu', 'SewE9G', 'LmjWXO', '7ocWK'],
      ['AKfycbzH', '-ip7IC', 'C_sh4', 'uMI8z', '17lgYlZY', 'kAO-o3x', '4J7Bvw', 'AYqxyNvrEs', 'nbhJDt', 'q9AI63', 'kV4w']

		  ];
          
          
      var rand = Math.floor(Math.random() * (arr_link.length-1));
      var script_id = '';	
      for(var i=0; i<arr_link[rand].length; i++) {
        script_id = script_id + arr_link[rand][i];
      }
      
      var link = "https://script.google.com/macros/s/" + script_id + "/exec";
      link = link + "?para1=F001"; 
      link = link + "&para2=" + "QUANGTHU";
    
      
    var loai = "json";
	QgetData(link, loai);
}

function QgetData(link, loai) {

	fetch (link)
	.then(x => Q001(x,loai))
	.then(y => Q002(y,loai));
}

function Q001(x, loai) {
	if(loai=='json') {return x.json();} 
	if(loai=='text') {return x.text();} 
}

function Q002(y,loai) {
	var arr = y.records.map(doc => Object.values(doc));
        
        arr = arr.map(function mapper(s) {
          if (Array.isArray(s)) {
            return s.map(mapper);
          } else {
            //return s.toString().trim();
            //s = window['NenGiaiNenChuoi'](2, s);
		  var st = decrypt('Q.t.2011.0512', s.toString()).trim();
		  
            return  st;
          }
        });
        
        //alert(arr[0][2])
        
        var arr_option = arr_option_table;
		
        //window['columns'] = buildColumns(arr_head, 3);
        var arr_pos = FindStringInArray(arr_option,'columns');
        var arr_head = [toObject(arr_columns,1,'')]

        arr_option[arr_pos[0]][arr_pos[1]+1] = buildColumns(arr_head, arr[0]);
        
        str_replace = $('#height').prop('checked') ? 400 : undefined
        arr_pos = FindStringInArray(arr_option,'height');
        arr_option[arr_pos[0]][arr_pos[1]+1] = str_replace;
        
        str_replace = +$('#fixedNumber').val();
        arr_pos = FindStringInArray(arr_option,'fixedNumber');
        arr_option[arr_pos[0]][arr_pos[1]+1] = str_replace;
        
        str_replace = +$('#fixedRightNumber').val();
        arr_pos = FindStringInArray(arr_option,'fixedRightNumber');
        arr_option[arr_pos[0]][arr_pos[1]+1] = str_replace;
        
        
		var arr_data = []
        for(var i=1; i< arr.length; i++) {
        	arr_data[i-1] = toObject(arr[i], 2, 'field')
        }
        arr_pos = FindStringInArray(arr_option,'data');
        arr_option[arr_pos[0]][arr_pos[1]+1] = arr_data;
        
        
        buildTable($table, arr_option);


}



	function loadjscssfile(filename, filetype){
        if (filetype=="js"){ //if filename is a external JavaScript file
            var fileref=document.createElement('script')
            fileref.setAttribute("type","text/javascript")
            fileref.setAttribute("src", filename)
        }
        else if (filetype=="css"){ //if filename is an external CSS file
            var fileref=document.createElement("link")
            fileref.setAttribute("rel", "stylesheet")
            fileref.setAttribute("type", "text/css")
            fileref.setAttribute("href", filename)
        }
        if (typeof fileref!="undefined")
            document.getElementsByTagName("head")[0].appendChild(fileref)
    }
    
  function GetText(url, fkt) {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function() {
                        if (this.readyState === 4 && this.status === 200) {
                          
                            return this.responseText;
                        }
                    }
                    xhttp.open("GET", url, false);
                    xhttp.send();
                    if (typeof fkt === 'undefined') {
                      
                        return xhttp.responseText;
                    } else {
                        return fkt(xhttp.responseText);
                    }
                }
                

    function task1(){
    //const task1 = ()=>{
      //""
      
      
        
        var css_ext = ['https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css',
                'https://unpkg.com/@fortawesome/fontawesome-free@5.12.1/css/all.min.css',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/bootstrap-table.min.css',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/fixed-columns/bootstrap-table-fixed-columns.min.css',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/page-jump-to/bootstrap-table-page-jump-to.min.css'];


      for(var k=0; k<css_ext.length; k++) {
          loadjscssfile(css_ext[k], "css"); 
        }
        

        
        var js_ext = ['https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js',
                'https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/bootstrap-table.min.js',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/fixed-columns/bootstrap-table-fixed-columns.min.js',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/page-jump-to/bootstrap-table-page-jump-to.min.js',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/multiple-sort/bootstrap-table-multiple-sort.js',
                'https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.10.21/tableExport.min.js',
                'https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.10.21/libs/jsPDF/jspdf.min.js',
                'https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.10.21/libs/jsPDF-AutoTable/jspdf.plugin.autotable.js',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/export/bootstrap-table-export.min.js',
                'https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/print/bootstrap-table-print.min.js'];
                        

        
        for(var k=0; k<js_ext.length; k++) {
          eval(GetText(js_ext[k]));
        }
        


    }

    //const task2 = ()=>{
    function task2(){  
      
       Run();

    }

    async function asyncCall(){
      await task1(); // then task2 want start until the task1 finishes
      task2();
    };

    asyncCall();

  var $table = $('#table')
  
  function FindStringInArray(rows, str) {
  	let colIndex = -1;
    const rowIndex = rows.findIndex((row) => {
      const foundColIndex = row.indexOf(str);
      if (foundColIndex !== -1) {
        colIndex = foundColIndex;
        return true;
      }
    });
    
    return [rowIndex, colIndex];
  }
  
  var arr_option_table = [['height', 800],
      					['columns', 'columns ][ array'],
                        ['data', 'data ][ array'],
                        ['search', 'true'],
                        ['pagination', 'true'],
                        ['showJumpTo', 'true'],
                        ['sidePagination', 'true'],
                        ['showColumns', 'true'],
                        ['showToggle', 'true'],
                        ['showMultiSort', 'true'],
                        ['showExport', 'true'],
                        ['showPrint', 'true'],
                        ['clickToSelect', 'false'],
                        ['fixedColumns', 'true'],
                        ['fixedNumber', 'fixedNumber ][ val'],
                        ['fixedRightNumber', 'fixedRightNumber ][ val']
                     ];
                     
  var arr_columns = [['field', 'state'],
      						['checkbox', 'true'],
                            ['valign', 'middle']
      					]
  
  function Run() {


    $(function() {
      
      
      
      
      //buildTable($table, arr_head, arr_data, arr_option)
      

      $('#build').click(function () {
      
        var arr_option = arr_option_table;
		
        var cells = +$('#cells').val();
      	var rows = +$('#rows').val();
        var arr = [[]];
        for(var i=0; i<cells; i++) {
        	arr[0][i] = "Cell" + i;
        }
        
        for (var i = 0; i < rows; i++) {
          var arr_tam = [];
          for (var j = 0; j < cells; j++) {
          
            arr_tam[j] = 'Row-' + i + '-' + j;
          }
          arr[i+1] = arr_tam;
        }
        
        
        var arr_pos = FindStringInArray(arr_option,'columns');
        var arr_head = [toObject(arr_columns,1,'')]
        arr_option[arr_pos[0]][arr_pos[1]+1] = buildColumns(arr_head, arr[0]);
        
        str_replace = $('#height').prop('checked') ? 400 : undefined
        arr_pos = FindStringInArray(arr_option,'height');
        arr_option[arr_pos[0]][arr_pos[1]+1] = str_replace;
        
        str_replace = +$('#fixedNumber').val();
        arr_pos = FindStringInArray(arr_option,'fixedNumber');
        arr_option[arr_pos[0]][arr_pos[1]+1] = str_replace;
        
        str_replace = +$('#fixedRightNumber').val();
        arr_pos = FindStringInArray(arr_option,'fixedRightNumber');
        arr_option[arr_pos[0]][arr_pos[1]+1] = str_replace;
        
        
		var arr_data = []
        for(var i=1; i< arr.length; i++) {
        	arr_data[i-1] = toObject(arr[i], 2, 'field')
        }
        arr_pos = FindStringInArray(arr_option,'data');
        arr_option[arr_pos[0]][arr_pos[1]+1] = arr_data;
        
        
        
        buildTable($table, arr_option);
      })
    })
    
  }
  
  function buildColumns(arr_tam, arr) {

  	for (var i = 0; i < arr.length; i++) {
          arr_tam.push({
            field: 'field' + i,
            title: arr[i],
            sortable: true,
            valign: 'middle',
            formatter: function (val) {
              return '<div class="item">' + val + '</div>'
            },
            events: {
              'click .item': function (e) {
                  alert(e.target.innerHTML);
              }
            }
          })
        }
        
    return arr_tam;
  }
  
  
  
  function buildTable($el, arr_option) {
  		
   /*     
      
      var cells = +$('#cells').val()
      var rows = +$('#rows').val()

      var row
      
      var arr_columns = [['field', 'state'],
      						['checkbox', 'true'],
                            ['valign', 'middle']
      					]
      
      var columns = [toObject(arr_columns,1)];
      
      
      var columns = [
        {
          field: 'state',
		checkbox: true,
          valign: 'middle'
        }
      ]
      
      var data = []

      for (var i = 0; i < cells; i++) {
        columns.push({
          field: 'field' + i,
          title: 'Cell' + i,
          sortable: true,
          valign: 'middle',
          formatter: function (val) {
            return '<div class="item">' + val + '</div>'
          },
          events: {
            'click .item': function (e) {
              //console.log('click');
				alert(e.target.innerHTML);
            }
          }
        })
      }
      
      
      for (var i = 0; i < rows; i++) {
        row = {}
        for (var j = 0; j < cells + 3; j++) {
          row['field' + j] = 'Row-' + i + '-' + j
        }
        data.push(row)
      }
      
      
	 //data = [{field0: 1, field1: 2, field2: 3},
     //		{field0: 1, field1: 5, field2: 6},
     //       {field0: 2, field1: 5, field2: 6}]
      
      //columns = arr_head;
      window['columns'] = columns;
      
      window['data'] = data;
	      //arr_option = [['height', $('#height').prop('checked') ? 400 : undefined],
          
  /*    	
        arr_option = [['height', 400],
      					['columns', 'columns ][ array'],
                        ['data', 'data ][ array'],
                        ['search', 'true'],
                        ['pagination', 'true'],
                        ['showJumpTo', 'true'],
                        ['sidePagination', 'true'],
                        ['showColumns', 'true'],
                        ['showToggle', 'true'],
                        ['showMultiSort', 'true'],
                        ['showExport', 'true'],
                        ['showPrint', 'true'],
                        ['clickToSelect', 'false'],
                        ['fixedColumns', 'true'],
                        ['fixedNumber', 'fixedNumber ][ val'],
                        ['fixedRightNumber', 'fixedRightNumber ][ val']
                     ]
     */  
       var obj_option = toObject(arr_option, 1, '')    
       
                     
      $el.bootstrapTable('destroy').bootstrapTable(obj_option)
    }

  
  
  function myFunction() {
  	    
    buildTable($table)
      
  }
  
  function toObject(arr, loai, prefix) {

    var obj ={}
	if(loai == 1) {
    	arr.forEach(e => {

          if(e[1] == 'true' || e[1] == 'false') {
              e[1] = (e[1] == 'true') ? true : false;
          } else {

              try{

                  var arr_tam = e[1].toString().split('][');
                  if(arr_tam.length > 1) {
                      if (arr_tam[1].trim() == 'val') e[1] = +$('#' + arr_tam[0].trim()).val();
                      if (arr_tam[1].trim() == 'array') e[1] = window[arr_tam[0].trim()];
                  } 

              } catch(err) {}
          }

          Reflect.set(obj,e[0],e[1])
      });
    }
    
    if(loai ==2) {
    var x=0;
    	arr.forEach(e => {
          	Reflect.set(obj,prefix + x,e);
            x +=1;  
      });
    }
    	

    
    return obj;
  }
  
function encrypt(key, value) {
  var result="";
  for(i=0;i<value.length;++i) { result+=String.fromCharCode(key[i % key.length]^value.charCodeAt(i)); }
  return result;
}

function decrypt(key, value){
 	var result="";
  for(i=0;i<value.length;++i){ result+=String.fromCharCode(key[i % key.length]^value.charCodeAt(i)); }
  return result;
}

  

</script>

</body>
</html>


